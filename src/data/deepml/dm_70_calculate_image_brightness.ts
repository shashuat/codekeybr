import { Problem } from '../../types';

export const DM_70_CALCULATE_IMAGE_BRIGHTNESS: Problem = {
  "id": "dm_70_calculate_image_brightness",
  "title": "Calculate Image Brightness",
  "difficulty": "Easy",
  "tags": [
    "Matrix Operations"
  ],
  "descriptionMarkdown": "Task: Image Brightness Calculator\n\nImplement a function `calculate_brightness(img)` that computes the average brightness of a grayscale image. The image is a 2D matrix (list of lists), where each element is a pixel value between 0 (black) and 255 (white).\n\nRequirements:\n- Return the average brightness of the image rounded to two decimal places.\n- Handle edge cases and return `-1` if any of the following occur:\n  - The image matrix is empty or has zero total pixels.\n  - Rows in the matrix have inconsistent lengths.\n  - Any pixel value is outside the valid range [0, 255].\n\nExample:\n```\nimg = [\n  [100, 200],\n  [50, 150]\n]\nprint(calculate_brightness(img))  # 125.0\n```\nReasoning: (100 + 200 + 50 + 150) / 4 = 125.0",
  "solutionExplanation": "We need to compute the mean of all pixel values in a 2D grayscale image representation while validating the input. The key checks are: non-empty matrix with non-zero total elements, consistent row lengths, and pixel values within [0, 255]. After validation, the average is the sum divided by the number of pixels, rounded to two decimal places.\n\nUsing PyTorch, we convert the input list-of-lists to a tensor, which lets us leverage vectorized checks and mean computation efficiently. We first verify structural integrity (non-empty and consistent row lengths) to avoid shape issues. Then we create a tensor and validate that all values are finite and within range using tensor-wise comparisons. Finally, we compute the mean with `torch.mean` and round the result to two decimals. If any validation fails or tensor creation is not possible, we return `-1` as specified.",
  "solutionCode": "import torch\n\ndef calculate_brightness(img):\n    \"\"\"\n    Calculate the average brightness of a grayscale image represented as a 2D list.\n\n    Args:\n        img (List[List[Number]]): 2D matrix of pixel values in [0, 255].\n\n    Returns:\n        float: Average brightness rounded to two decimals, or -1 on invalid input.\n    \"\"\"\n    # Basic structural validation\n    if not isinstance(img, (list, tuple)) or len(img) == 0:\n        return -1\n    if not all(isinstance(row, (list, tuple)) for row in img):\n        return -1\n\n    row_lengths = [len(row) for row in img]\n    if len(row_lengths) == 0 or any(l == 0 for l in row_lengths):\n        return -1\n    if len(set(row_lengths)) != 1:\n        return -1\n\n    # Convert to tensor and validate values\n    try:\n        x = torch.as_tensor(img, dtype=torch.float32)\n    except Exception:\n        return -1\n\n    # Ensure tensor is 2D and has elements\n    if x.numel() == 0 or x.dim() != 2:\n        return -1\n\n    # Check value range and finiteness\n    valid = torch.isfinite(x) & (x >= 0.0) & (x <= 255.0)\n    if not bool(valid.all().item()):\n        return -1\n\n    # Compute mean brightness and round to two decimals\n    mean_val = x.mean().item()\n    return round(mean_val, 2)\n\n\ndef solution():\n    # Example usage\n    img = [\n        [100, 200],\n        [50, 150]\n    ]\n    result = calculate_brightness(img)\n    print(result)  # Expected: 125.0\n    return result\n",
  "timeComplexity": "O(N)",
  "spaceComplexity": "O(N)",
  "platform": "deepml"
};
